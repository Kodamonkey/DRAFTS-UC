# ==============================================================================
# DRAFTS++ CONFIGURATION - ASTRONOMER ESSENTIALS
# ==============================================================================
#
# This file contains the most commonly used settings for astronomical analysis.
# For advanced configurations, see the files in the advanced-config/ directory:
#
# - advanced-config/performance.yaml  : Advanced performance optimization
# - advanced-config/visualization.yaml: Detailed plotting and visualization settings
# - advanced-config/models.yaml       : Neural network model configurations
# - advanced-config/logging.yaml      : Advanced logging and debugging options
#
# ==============================================================================

# ==============================================================================
# DATA AND FILE PATHS
# ==============================================================================
data:
  # Directory containing input files (.fits, .fil)
  input_dir: "./Data/raw/"

  # Directory where results will be saved (CSVs, plots, logs)
  results_dir: "./Results-polarization-finales/"

  # List of files to process (search patterns)
  # Can specify full names or partial patterns
  # Pipeline will search for files matching any of these patterns
  targets:
    - "B0355+54_FB_20220918"
    # - "FRB20201124_0009"
    # - "FRB20180301_0002"
    # - "FRB20180301_0001"

# ==============================================================================
# TEMPORAL ANALYSIS
# ==============================================================================
temporal:
  # Duration of each temporal segment in milliseconds
  # Common values for FRBs: 100-500 ms, Pulsars: 1000-5000 ms
  slice_duration_ms: 1000.0

# ==============================================================================
# DOWNSAMPLING (DATA REDUCTION)
# ==============================================================================
downsampling:
  # Frequency reduction factor (1 = no reduction)
  # Higher values = faster processing, lower frequency resolution
  # Values: 1, 2, 4, 8
  frequency_rate: 1

  # Time reduction factor (1 = no reduction)
  # Higher values = faster processing, lower time resolution
  # Common values: 4, 8, 16, 32
  time_rate: 8

# ==============================================================================
# DISPERSION MEASURE (DM) SEARCH RANGE
# ==============================================================================
dispersion:
  # DM search range in pc cm⁻³
  # Adjust according to your source:
  # - Nearby pulsars: 0-100
  # - Extragalactic FRBs: 100-2000
  # - General/unknown: 0-1024
  dm_min: 0
  dm_max: 100

# ==============================================================================
# DETECTION THRESHOLDS
# ==============================================================================
thresholds:
  # Minimum probability for valid detection (CenterNet)
  # Higher values = fewer detections but more confidence
  # - Conservative: 0.5-0.7
  # - Balanced: 0.3 (default)
  # - Sensitive: 0.1-0.2
  detection_probability: 0.3

  # Minimum probability to classify as burst (ResNet)
  # Higher values = more conservative classification
  # - Conservative: 0.7-0.9
  # - Balanced: 0.5 (default)
  # - Sensitive: 0.3-0.4
  classification_probability: 0.5

  # SNR threshold for highlighting in visualizations
  # Does not affect detection, only visualization
  # - Conservative: 5.0-10.0
  # - Balanced: 3.0-7.0
  # - Sensitive: 1.0-5.0
  snr_threshold: 5.0

# ==============================================================================
# MULTI-BAND ANALYSIS
# ==============================================================================
multiband:
  # Enable multi-band analysis (Full/Low/High frequency bands)
  # Useful for:
  # - Detailed frequency characterization
  # - Identifying band-dependent RFI
  # - Scattering studies
  # Note: Increases processing time ~3x
  enabled: false

# ==============================================================================
# HIGH-FREQUENCY PIPELINE (>8 GHz)
# ==============================================================================
high_frequency:
  # Automatically enable high-frequency pipeline
  # when central frequency exceeds threshold
  # Useful for: ALMA, mm-wave observations
  auto_enable: true

  # Central frequency threshold in MHz
  # Default: 8000 MHz (8 GHz) for ALMA
  threshold_mhz: 8000.0

  # Enable dual-polarization validation
  # Requires peaks to appear in both Intensity AND Linear polarization
  # - true: More conservative, better RFI rejection
  # - false: Faster, single-polarization detection
  enable_linear_validation: false

# ==============================================================================
# POLARIZATION (PSRFITS)
# ==============================================================================
polarization:
  # Polarization mode for PSRFITS files with IQUV
  # Options:
  # - "intensity"  : Stokes I (total intensity) [DEFAULT]
  # - "linear"     : Linear polarization √(Q² + U²)
  # - "circular"   : Circular polarization |V|
  # - "pol0/1/2/3" : Individual polarizations
  mode: "intensity"

  # Default index when IQUV not available (e.g., AABB)
  # Values: 0-3
  default_index: 0

# ==============================================================================
# BASIC PERFORMANCE SETTINGS
# ==============================================================================
performance:
  # Maximum RAM fraction to use (0.1 = 10%, 0.25 = 25%)
  # Lower values are safer for systems with limited RAM
  # Recommended values:
  # - 0.10: Very conservative (4-8GB RAM systems)
  # - 0.15: Conservative (8-16GB RAM systems) [CURRENT]
  # - 0.25: Balanced (16GB+ RAM systems)
  #
  # DEPENDENCY: This value affects dm_chunking_threshold_gb below.
  # RAM_utilizable = (RAM_total × max_ram_fraction × 0.8) / 1.3
  # When changing this, adjust dm_chunking_threshold_gb accordingly.
  max_ram_fraction: 0.15

  # Maximum chunk size in samples
  # Prevents memory issues with very large files
  # Recommended values:
  # - 250,000: Very conservative (~13s chunks)
  # - 500,000: Conservative (~25s chunks) [CURRENT]
  # - 1,000,000: Balanced (~51s chunks)
  max_chunk_samples: 500000

  # Maximum DM-time cube size (GB)
  # Limits the size of the DM-time cube directly, regardless of chunk size
  # This is especially important for high DM ranges (DM > 1000)
  # The system will automatically reduce chunk size if needed to respect this limit
  # Recommended values:
  # - 1.0: Very conservative (for systems with limited RAM/VRAM)
  # - 2.0: Conservative (good balance) [CURRENT]
  # - 4.0: Balanced (for systems with more RAM/VRAM)
  # - 8.0: Aggressive (for high-end systems)
  #
  # NOTE: This limit works together with max_chunk_samples above.
  # The system uses the MORE RESTRICTIVE limit.
  # Example: With DM=10000, even 500K samples would create a ~56 GB cube.
  # This limit (2 GB) will automatically reduce chunk to ~16K samples.
  max_dm_cube_size_gb: 2.0

  # DM chunking threshold (GB)
  # If DM-time cube would exceed this size, automatically split DM range
  # This is the most important parameter for preventing memory errors
  #
  # DEPENDENCY: This value should be related to max_ram_fraction above.
  # Formula: RAM_utilizable = (RAM_total × max_ram_fraction × 0.8) / 1.3
  # Recommended: dm_chunking_threshold_gb = RAM_utilizable × (0.5 to 1.5)
  #
  # Examples (assuming 16GB RAM total):
  # - max_ram_fraction=0.10 → RAM_utilizable=0.98 GB → threshold=0.5-1.5 GB
  # - max_ram_fraction=0.15 → RAM_utilizable=1.48 GB → threshold=0.7-2.2 GB [CURRENT]
  # - max_ram_fraction=0.25 → RAM_utilizable=2.46 GB → threshold=1.2-3.7 GB
  #
  # Quick reference by RAM total (with max_ram_fraction=0.15):
  # - 8 GB RAM:  RAM_utilizable=0.74 GB  → threshold=0.5-1.0 GB
  # - 16 GB RAM: RAM_utilizable=1.48 GB → threshold=1.0-2.0 GB [CURRENT]
  # - 32 GB RAM: RAM_utilizable=2.95 GB → threshold=2.0-4.0 GB
  # - 64 GB RAM: RAM_utilizable=5.91 GB → threshold=4.0-8.0 GB
  dm_chunking_threshold_gb: 2.0

# ==============================================================================
# OUTPUT CONTROL
# ==============================================================================
output:
  # Control which candidates to save to CSV
  #
  # For STANDARD PIPELINE (<8 GHz):
  #   true  = Save only candidates classified as BURST by ResNet
  #   false = Save all CenterNet detections (BURST and NON-BURST)
  #
  # For HIGH-FREQUENCY PIPELINE (≥8 GHz with multi-pol):
  #   true  = Save ONLY if ResNet classifies BURST in BOTH Intensity AND Linear
  #   false = Save if ResNet classifies BURST in Intensity (regardless of Linear)
  #
  # Recommendation:
  #   - Use 'true' for production (highest confidence)
  #   - Use 'false' for exploratory analysis
  save_only_burst: false

# ==============================================================================
# DEBUG AND DIAGNOSTICS
# ==============================================================================
debug:
  # Show detailed frequency and file information
  # Useful for diagnosing frequency ordering issues
  show_frequency_info: false

  # Force plot generation even without candidates
  # Useful for verifying data quality and debugging
  force_plots: false
# ==============================================================================
# ADVANCED CONFIGURATIONS
# ==============================================================================
#
# For more detailed control over the pipeline behavior, edit these files:
#
# advanced-config/performance.yaml:
#   - Advanced memory management
#   - GPU optimization settings
#   - I/O and parallel processing options
#   - Profiling and benchmarking tools
#
# advanced-config/visualization.yaml:
#   - Plot styling and colormaps
#   - SNR visualization settings
#   - DM range plotting options
#   - Export formats and quality
#
# advanced-config/models.yaml:
#   - Neural network architecture settings
#   - Inference optimization options
#   - Model validation and debugging
#   - Experimental features
#
# advanced-config/logging.yaml:
#   - Detailed logging configuration
#   - Component-specific log levels
#   - Performance monitoring
#   - Error handling and analysis
#
# ==============================================================================
